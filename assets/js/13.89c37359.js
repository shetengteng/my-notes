(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1291:function(t,e,o){"use strict";o.r(e);var s=o(15),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"leo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#leo"}},[t._v("#")]),t._v(" LEO")]),t._v(" "),s("blockquote",[s("p",[t._v("Log End Offset")])]),t._v(" "),s("p",[t._v("每个副本的最后一个offset，LEO是最新的offset+1")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(782)}}),t._v(" "),s("h2",{attrs:{id:"hw"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hw"}},[t._v("#")]),t._v(" HW")]),t._v(" "),s("blockquote",[s("p",[t._v("High Watermark")])]),t._v(" "),s("p",[s("strong",[t._v("所有副本中")]),t._v("最小的LEO")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(783)}}),t._v(" "),s("h2",{attrs:{id:"follower-故障处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#follower-故障处理"}},[t._v("#")]),t._v(" Follower 故障处理")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Follower从Leader中拉取数据，进行数据同步")])]),t._v(" "),s("li",[s("p",[t._v("Follower发生故障后会被临时提出ISR，此时Leader和Follower继续接收数据，如下图紫色部分")])])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(784)}}),t._v(" "),s("ul",[s("li",[t._v("该Follower恢复后，Follower会读取本地磁盘记录的上次的HW，并将log文件高于HW的部分截取掉，从HW开始向Leader进行同步")])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(785)}}),t._v(" "),s("ul",[s("li",[t._v("等"),s("strong",[t._v("该Follower的LEO >= 该partition的HW")]),t._v("，即Follower追上Leader之后，就可以重新加入ISR中")])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(786)}}),t._v(" "),s("h2",{attrs:{id:"leader-故障处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#leader-故障处理"}},[t._v("#")]),t._v(" Leader 故障处理")]),t._v(" "),s("ul",[s("li",[t._v("Leader发生故障后，会从ISR中选出一个新的Leader")])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(787)}}),t._v(" "),s("ul",[s("li",[t._v("为保证多个副本之间的数据一致性，其余的Follower会先将各自的log文件高于HW的部分截取掉，然后从新的Leader同步数据")]),t._v(" "),s("li",[t._v("注意：kafka只能"),s("strong",[t._v("保证副本之间的数据一致性")]),t._v("，并不能保证数据不丢失或者不重复")])]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:o(788)}})])}),[],!1,null,null,null);e.default=r.exports},782:function(t,e,o){t.exports=o.p+"assets/img/leo.6f667d7e.png"},783:function(t,e,o){t.exports=o.p+"assets/img/hw.00782aec.png"},784:function(t,e,o){t.exports=o.p+"assets/img/follower2.acec2321.png"},785:function(t,e,o){t.exports=o.p+"assets/img/follower3.45fab1f7.png"},786:function(t,e,o){t.exports=o.p+"assets/img/follower4.dc2ebc78.png"},787:function(t,e,o){t.exports=o.p+"assets/img/leader.ca024697.png"},788:function(t,e,o){t.exports=o.p+"assets/img/leader2.4fe26589.png"}}]);