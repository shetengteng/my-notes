(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1148:function(s,a,n){"use strict";n.r(a);var t=n(15),l=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("🔥 "),t("a",{attrs:{href:"https://www.bilibili.com/video/BV18t411f7CN",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频教程"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("中文权威指南")]),s._v(" "),t("ul",[t("li",[s._v("http://www.ansible.com.cn/")])]),s._v(" "),t("p",[s._v("推荐资料")]),s._v(" "),t("ul",[t("li",[s._v("http://galaxy.ansible.com")]),s._v(" "),t("li",[s._v("https://galaxy.ansible.com/explore#/")]),s._v(" "),t("li",[s._v("http://github.com/")]),s._v(" "),t("li",[s._v("http://ansible.com.cn/")]),s._v(" "),t("li",[s._v("https://github.com/ansible/ansible")]),s._v(" "),t("li",[s._v("https://github.com/ansible/ansible-examples")])]),s._v(" "),t("h2",{attrs:{id:"关于运维背景知识"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于运维背景知识"}},[s._v("#")]),s._v(" 关于运维背景知识")]),s._v(" "),t("h3",{attrs:{id:"运维自动化发展历程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运维自动化发展历程"}},[s._v("#")]),s._v(" 运维自动化发展历程")]),s._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:n(931),alt:"image"}}),s._v(" "),t("p",[s._v("类比")]),s._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:n(932)}}),s._v(" "),t("h3",{attrs:{id:"企业应用场景分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#企业应用场景分析"}},[s._v("#")]),s._v(" 企业应用场景分析")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Dev开发环境\n    使用者：程序员\n    功能：程序员开发软件，测试BUG的环境\n    管理者：程序员\n\n测试环境\n    使用者：QA测试工程师\n    功能：测试经过Dev环境测试通过的软件的功能\n    管理者：运维\n\n说明：测试环境往往有多套,测试环境满足测试功能即可，不宜过多\n1、测试人员希望测试环境有多套,公司的产品多产品线并发，即多个版本，意味着多个版本同步测试\n2、通常测试环境有多少套和产品线数量保持一样\n\n发布环境：代码发布机，有些公司为堡垒机（安全屏障）\n    使用者：运维\n    功能：发布代码至生产环境\n    管理者：运维（有经验）\n    发布机：往往需要有2台（主备）\n\n生产环境\n    使用者：运维，少数情况开放权限给核心开发人员，极少数公司将权限完全\n    开放给开发人员并其维护\n    功能：对用户提供公司产品的服务\n\n管理者：只能是运维\n    生产环境服务器数量：一般比较多，且应用非常重要。往往需要自动工具协助部署配置应用\n\n灰度环境（生产环境的一部分）\n    使用者：运维\n    功能：在全量发布代码前将代码的功能面向少量精准用户发布的环境,可基\n    于主机或用户执行灰度发布\n    案例：共100台生产服务器，先发布其中的10台服务器，这10台服务器就是灰度服务器\n    管理者：运维\n    灰度环境：往往该版本功能变更较大，为保险起见特意先让一部分用户优化体验该功能，\n              待这部分用户使用没有重大问题的时候，再全量发布至所有服务器\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("h3",{attrs:{id:"程序发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#程序发布"}},[s._v("#")]),s._v(" 程序发布")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("程序发布要求：\n    不能导致系统故障或造成系统完全不可用\n    不能影响用户体验\n预发布验证：\n    新版本的代码先发布到服务器（跟线上环境配置完全相同，只是未接入到调度器）\n灰度发布：\n    基于主机，用户，业务\n发布路径：\n    /webapp/tuangou\n    /webapp/tuangou-1.1\n    /webapp/tuangou-1.2\n发布过程：在调度器上下线一批主机(标记为maintanance状态) --\x3e 关闭服务 --\x3e\n          部署新版本的应用程序 --\x3e 启动服务 --\x3e 在调度器上启用这一批服务器\n自动化灰度发布：脚本、发布平台\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"常用自动化运维工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用自动化运维工具"}},[s._v("#")]),s._v(" 常用自动化运维工具")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Ansible")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("python")])]),s._v(" "),t("li",[t("p",[s._v("不需要部署agent，基于ssh")])]),s._v(" "),t("li",[t("p",[s._v("中小型应用环境")]),s._v(" "),t("ul",[t("li",[s._v("由于是基于ssh，那么机器过多，执行效率低，适合300+左右的机器的企业使用")])])])])]),s._v(" "),t("li",[t("p",[s._v("Saltstack")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("python")])]),s._v(" "),t("li",[t("p",[s._v("需要部署agent")])]),s._v(" "),t("li",[t("p",[s._v("执行效率高")])])])]),s._v(" "),t("li",[t("p",[s._v("Puppet")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("ruby")])]),s._v(" "),t("li",[t("p",[s._v("功能强大，配置复杂，重型")])]),s._v(" "),t("li",[t("p",[s._v("适合大型环境")])])])]),s._v(" "),t("li",[t("p",[s._v("Fabric")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("python")])]),s._v(" "),t("li",[t("p",[s._v("不需要部署agent")])])])]),s._v(" "),t("li",[t("p",[s._v("Chef")]),s._v(" "),t("ul",[t("li",[s._v("ruby")])])]),s._v(" "),t("li",[t("p",[s._v("Cfengine")])]),s._v(" "),t("li",[t("p",[s._v("func")])])]),s._v(" "),t("h2",{attrs:{id:"ansible简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible简介"}},[s._v("#")]),s._v(" Ansible简介")]),s._v(" "),t("blockquote",[t("p",[s._v("Michael DeHaan（ Cobbler 与 Func 作者）")]),s._v(" "),t("p",[s._v("名称来自《安德的游戏》中跨越时空的即时通信工具")]),s._v(" "),t("p",[s._v("2012-03-09，发布0.0.1版，2015-10-17，Red Hat宣布收购")]),s._v(" "),t("p",[s._v("官网：https://www.ansible.com/")]),s._v(" "),t("p",[s._v("官方文档：https://docs.ansible.com/")])]),s._v(" "),t("h3",{attrs:{id:"企业级自动化运维工具应用实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#企业级自动化运维工具应用实战"}},[s._v("#")]),s._v(" 企业级自动化运维工具应用实战")]),s._v(" "),t("p",[s._v("公司计划在年底做一次大型市场促销活动，全面冲刺下交易额，为明年的上市做准备。\n公司要求各业务组对年底大促做准备，运维部要求所有业务容量进行三倍的扩容，并搭建出多套环境可以共开发和测试人员做测试，运维老大为了在年底有所表现，要求运维部门同学尽快实现，当你接到这个任务时，有没有更快的解决方案？")]),s._v(" "),t("p",[s._v("临时使用阿里云等环境，搭建临时服务器")]),s._v(" "),t("h2",{attrs:{id:"ansible特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible特性"}},[s._v("#")]),s._v(" Ansible特性")]),s._v(" "),t("ul",[t("li",[s._v("模块化：调用特定的模块，完成特定任务，1000+")]),s._v(" "),t("li",[s._v("Paramiko（基于python对ssh的实现），PyYAML，Jinja2（模板语言）三个关键模块")]),s._v(" "),t("li",[s._v("支持自定义模块")]),s._v(" "),t("li",[s._v("基于Python语言实现")]),s._v(" "),t("li",[s._v("部署简单，基于python和SSH(默认已安装)，agentless")]),s._v(" "),t("li",[s._v("安全，基于OpenSSH")]),s._v(" "),t("li",[s._v("支持playbook编排任务，使用role实现多个playbook的组合")]),s._v(" "),t("li",[s._v("幂等性：一个任务执行1遍和执行n遍效果一样，不因重复执行带来意外情况")]),s._v(" "),t("li",[s._v("无需代理不依赖PKI（无需ssl）")]),s._v(" "),t("li",[s._v("可使用任何编程语言写模块")]),s._v(" "),t("li",[s._v("YAML格式，编排任务，支持丰富的数据结构")]),s._v(" "),t("li",[s._v("较强大的多层解决方案")])]),s._v(" "),t("h2",{attrs:{id:"ansible架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible架构"}},[s._v("#")]),s._v(" Ansible架构")]),s._v(" "),t("blockquote",[t("p",[s._v("ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。")])]),s._v(" "),t("p",[s._v("ansible是基于模块工作的，本身没有批量部署的能力，真正具有批量部署的是ansible所运行的模块，ansible只是提供一种框架，主要包括")]),s._v(" "),t("ul",[t("li",[s._v("connection plugins：连接插件，负责和被监控端实现通信")]),s._v(" "),t("li",[s._v("host inventory：配置文件，定义操作的主机\n"),t("ul",[t("li",[s._v("各种模块核心模块、command模块、自定义模块")]),s._v(" "),t("li",[s._v("借助于插件完成记录日志邮件等功能")]),s._v(" "),t("li",[s._v("playbook：剧本执行多个任务时，非必需可以让节点一次性运行多个任务")])])])]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:n(933)}}),s._v(" "),t("h2",{attrs:{id:"ansible工作原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible工作原理"}},[s._v("#")]),s._v(" Ansible工作原理")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:n(934),alt:"image"}}),s._v(" "),t("h3",{attrs:{id:"主要组成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主要组成"}},[s._v("#")]),s._v(" 主要组成")]),s._v(" "),t("p",[t("strong",[s._v("ANSIBLE PLAYBOOKS")])]),s._v(" "),t("ul",[t("li",[s._v("任务剧本，任务集")]),s._v(" "),t("li",[s._v("编排定义Ansible任务集的配置文件，由Ansible顺序依次执行，通常是JSON格式的YML文件")])]),s._v(" "),t("p",[t("strong",[s._v("INVENTORY")])]),s._v(" "),t("ul",[t("li",[s._v("Ansible管理主机的清单  /etc/anaible/hosts")])]),s._v(" "),t("p",[t("strong",[s._v("MODULES")])]),s._v(" "),t("ul",[t("li",[s._v("Ansible执行命令的功能模块，多数为内置核心模块，也可自定义")])]),s._v(" "),t("p",[t("strong",[s._v("PLUGINS")])]),s._v(" "),t("ul",[t("li",[s._v("模块功能的补充，如连接类型插件、循环插件、变量插件、过滤插件等")]),s._v(" "),t("li",[s._v("该功能不常用")])]),s._v(" "),t("p",[t("strong",[s._v("API")])]),s._v(" "),t("ul",[t("li",[s._v("供第三方程序调用的应用程序编程接口")])]),s._v(" "),t("p",[t("strong",[s._v("ANSIBLE")])]),s._v(" "),t("ul",[t("li",[s._v("组合INVENTORY、API、MODULES、PLUGINS的绿框")]),s._v(" "),t("li",[s._v("可理解为是ansible命令工具，其为核心执行工具")])]),s._v(" "),t("h3",{attrs:{id:"执行命令来源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行命令来源"}},[s._v("#")]),s._v(" 执行命令来源")]),s._v(" "),t("ul",[t("li",[s._v("USER，普通用户，即SYSTEM ADMINISTRATOR")]),s._v(" "),t("li",[s._v("CMDB（配置管理数据库） API 调用")]),s._v(" "),t("li",[s._v("PUBLIC/PRIVATE CLOUD API调用  (公有私有云的API接口调用)")]),s._v(" "),t("li",[s._v("USER-> Ansible Playbook -> Ansibile")])]),s._v(" "),t("h3",{attrs:{id:"利用ansible实现管理的方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#利用ansible实现管理的方式"}},[s._v("#")]),s._v(" 利用ansible实现管理的方式")]),s._v(" "),t("p",[t("strong",[s._v("Ad-Hoc")])]),s._v(" "),t("ul",[t("li",[s._v("即ansible单条命令")]),s._v(" "),t("li",[s._v("主要用于临时命令使用场景")])]),s._v(" "),t("p",[t("strong",[s._v("Ansible-playbook")])]),s._v(" "),t("ul",[t("li",[s._v("主要用于长期规划好的，大型项目的场景")]),s._v(" "),t("li",[s._v("需要有前期的规划过程")]),s._v(" "),t("li",[s._v("执行过程\n"),t("ul",[t("li",[s._v("将已有编排好的任务集写入Ansible-Playbook")]),s._v(" "),t("li",[s._v("通过ansible-playbook命令分拆任务集至逐条ansible命令，按预定规则逐条执行")])])])]),s._v(" "),t("h3",{attrs:{id:"ansible主要操作对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ansible主要操作对象"}},[s._v("#")]),s._v(" Ansible主要操作对象")]),s._v(" "),t("ul",[t("li",[s._v("HOSTS主机")]),s._v(" "),t("li",[s._v("NETWORKING网络设备")])]),s._v(" "),t("h2",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),t("p",[s._v("ansible不是服务,不会一直启动,只是需要的时候启动")]),s._v(" "),t("p",[s._v("主控端")]),s._v(" "),t("ul",[t("li",[s._v("执行ansible的主机一般称为主控端，中控，master或堡垒机")]),s._v(" "),t("li",[s._v("主控端Python版本需要2.6或以上")]),s._v(" "),t("li",[s._v("windows不能做为主控端")])]),s._v(" "),t("p",[s._v("被控端")]),s._v(" "),t("ul",[t("li",[s._v("被控端Python版本小于2.4需要安装python-simplejson")]),s._v(" "),t("li",[s._v("被控端如开启SELinux需要安装libselinux-python")])])])}),[],!1,null,null,null);a.default=l.exports},931:function(s,a,n){s.exports=n.p+"assets/img/saas.a77cd4bb.png"},932:function(s,a,n){s.exports=n.p+"assets/img/saas2.aa620aa7.png"},933:function(s,a,n){s.exports=n.p+"assets/img/structure.52d82d1a.png"},934:function(s,a,n){s.exports=n.p+"assets/img/work_flow.e630e67c.png"}}]);