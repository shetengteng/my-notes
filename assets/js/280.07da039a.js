(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{1058:function(s,a,n){"use strict";n.r(a);var t=n(15),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("主要的命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible\nansible-doc\nansible-playbook\nansible-vault\nansible-console\nansible-galaxy\nansible-pull\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"ansible-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-命令"}},[s._v("#")]),s._v(" ansible 命令")]),s._v(" "),n("blockquote",[n("p",[s._v("ansible通过ssh实现配置管理、应用部署、任务执行等功能")]),s._v(" "),n("p",[s._v("建议配置ansible端能基于密钥认证的方式联系各被管理节点")])]),s._v(" "),n("p",[s._v("本质是一个ansible执行命令的软连接")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host-pattern"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-m module_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-a args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible +被管理的主机(ALL) +模块  +参数")]),s._v("\n    --version              显示版本\n    -m module              指定模块，默认为command\n    -v                     详细过程 –vv -vvv更详细\n    --list-hosts           显示主机列表，可简写 --list\n    -k, --ask-pass         提示输入ssh连接密码,默认Key验证\n    -C, --check            检查，并不执行\n    -T, --timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("TIMEOUT  执行命令的超时时间,默认10s\n    -u, --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("REMOTE_USER 执行远程执行的用户\n    -b, --become           代替旧版的sudo切换\n        --become-user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("USERNAME 指定sudo的runas用户,默认为root\n    -K, --ask-become-pass  提示输入sudo时的口令\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"查看帮助"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看帮助"}},[s._v("#")]),s._v(" 查看帮助")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible --help\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"测试主机是否连通"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试主机是否连通"}},[s._v("#")]),s._v(" 测试主机是否连通")]),s._v(" "),n("blockquote",[n("p",[s._v("检测所有主机的网络状态，默认情况下连接被管理的主机是ssh基于key验证,如果没有配置key，权限将会被拒绝")]),s._v(" "),n("p",[s._v("因此需要指定以谁的身份连接,输入用户密码,必须保证被管理主机用户密码一致")]),s._v(" "),n("p",[s._v("ansible all -m ping -k")]),s._v(" "),n("p",[s._v("或者实现基于key验证 将公钥ssh-copy-id到被管理的主机上 , 实现免密登录")]),s._v(" "),n("p",[s._v("ansible all -m ping")])]),s._v(" "),n("p",[s._v("使用ansible的ping模块进行测试，通过 -m 参数调用模块")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m ping")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": provided hosts list is empty, only localhost is available. Note that the implicit localhost\ndoes not match "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'all'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Could not match supplied "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" pattern, ignoring: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("有警告信息，需要添加到hosts清单中")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/ansible/hosts")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加要测试的主机")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("再次尝试，由于没有权限（ansible 的ping是通过ssh协议进行访问）报错")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m ping")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" UNREACHABLE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"msg"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password)."')]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unreachable"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("使用用户名和密码进行访问，使用-k进行输入密码，而用户名则是当前主机的用户（如当前使用root登录），如果要使用其他用户，可以使用-u指定用户名")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m ping -k")]),s._v("\nSSH password: "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"对多台主机发送ping命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#对多台主机发送ping命令"}},[s._v("#")]),s._v(" 对多台主机发送ping命令")]),s._v(" "),n("p",[s._v("给多台主机发送命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102,192.168.10.103 -m ping -k")]),s._v("\nSSH password: \n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" FAILED"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"msg"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this.  Please add this host\'s fingerprint to your known_hosts file to manage this host."')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("对于报错信息  "),n("code",[s._v("known_hosts")]),s._v(" 需要调用ssh先登录一下，作为一个可信的host")]),s._v(" "),n("ul",[n("li",[s._v("注意：使用Ctrl + D退出ssh")]),s._v(" "),n("li",[s._v("注意：如果在ansible配置文件中host_key_checking=false，则不会出现该错误，则不需要执行如下命令")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("重新发送多个主机的ping命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102,192.168.10.103 -m ping -k")]),s._v("\nSSH password: \n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("如此操作的缺点：多个主机使用相同的key，如何解决，需要对其他被控机进行秘钥对配置")]),s._v(" "),n("h4",{attrs:{id:"对所有主机发送ping命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#对所有主机发送ping命令"}},[s._v("#")]),s._v(" 对所有主机发送ping命令")]),s._v(" "),n("p",[s._v("针对配置的/etc/ansible/hosts中的所有主机执行相同的命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible all -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -k\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("在进行ssh-keygen配置后，可以执行如下命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible all -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"使用主机分组进行命令发送"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用主机分组进行命令发送"}},[s._v("#")]),s._v(" 使用主机分组进行命令发送")]),s._v(" "),n("p",[s._v("在主机清单中配置如下")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("websrvs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(":4"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("执行命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible websrvs -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -k\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"查看主机列表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看主机列表"}},[s._v("#")]),s._v(" 查看主机列表")]),s._v(" "),n("p",[s._v("使用--list-host查看，也可以使用--list查看")]),s._v(" "),n("p",[s._v("列出所有主机")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all --list-hosts ")]),s._v("\n  hosts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("列出指定分组的主机")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible websrvs  --list-hosts")]),s._v("\n  hosts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible websrvs  --list")]),s._v("\n  hosts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"在group中指定某台主机执行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在group中指定某台主机执行"}},[s._v("#")]),s._v(" 在group中指定某台主机执行")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible websrvs -a "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'getent passwd test2'")]),s._v(" --limit"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.101\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"host-pattern"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#host-pattern"}},[s._v("#")]),s._v(" host-pattern")]),s._v(" "),n("p",[s._v("匹配主机的列表，对于逻辑条件，推荐使用单引号括起来")]),s._v(" "),n("h4",{attrs:{id:"all"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#all"}},[s._v("#")]),s._v(" All")]),s._v(" "),n("p",[s._v("表示所有Inventory中的所有主机")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible all –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"通配符"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通配符"}},[s._v("#")]),s._v(" 通配符 "),n("code",[s._v("*")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# *表示所有主机")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.* -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*srvs"')]),s._v(" -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"或关系"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#或关系"}},[s._v("#")]),s._v(" 或关系 "),n("code",[s._v(":")])]),s._v(" "),n("p",[s._v("取得并集")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"websrvs:appsrvs"')]),s._v(" -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\nansible “192.168.1.10:192.168.1.20” -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"逻辑与"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#逻辑与"}},[s._v("#")]),s._v(" 逻辑与 "),n("code",[s._v(":&")])]),s._v(" "),n("p",[s._v("取得交集")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在websrvs组并且在dbsrvs组中的主机")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"websrvs:&dbsrvs"')]),s._v(" –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"逻辑非"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#逻辑非"}},[s._v("#")]),s._v(" 逻辑非 "),n("code",[s._v(":!")])]),s._v(" "),n("p",[s._v("注意：此处为单引号")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在websrvs组，但不在dbsrvs组中的主机")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'websrvs:!dbsrvs'")]),s._v(" –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"综合逻辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#综合逻辑"}},[s._v("#")]),s._v(" 综合逻辑")]),s._v(" "),n("p",[s._v("注意：此处为单引号")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'websrvs:dbsrvs:&appsrvs:!ftpsrvs'")]),s._v(" –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"正则表达式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#正则表达式"}},[s._v("#")]),s._v(" 正则表达式")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"websrvs:&dbsrvs"')]),s._v(" –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"~(web|db).*\\.stt\\.com"')]),s._v(" –m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"命令执行过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令执行过程"}},[s._v("#")]),s._v(" 命令执行过程")]),s._v(" "),n("ol",[n("li",[s._v("加载自己的配置文件，默认/etc/ansible/ansible.cfg")]),s._v(" "),n("li",[s._v("加载自己对应的模块文件，如command")]),s._v(" "),n("li",[s._v("通过ansible将模块或命令生成对应的临时py文件，并将该文件传输至远程服务器的对应执行用户$HOME/.ansible/tmp/ansible-tmp-数字/XXX.PY文件")]),s._v(" "),n("li",[s._v("给文件+x执行")]),s._v(" "),n("li",[s._v("执行并返回结果")]),s._v(" "),n("li",[s._v("删除临时py文件，sleep 0退出")])]),s._v(" "),n("p",[s._v("执行状态")]),s._v(" "),n("ul",[n("li",[s._v("绿色：执行成功并且不需要做改变的操作")]),s._v(" "),n("li",[s._v("黄色：执行成功并且对目标主机做变更")]),s._v(" "),n("li",[s._v("红色：执行失败")])]),s._v(" "),n("p",[s._v("使用-vv查看执行过程，如果使用-vvv可以查看更加详细的步骤")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.103 -m ping -vv")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.9")]),s._v(".27\n  config "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /etc/ansible/ansible.cfg\n  configured module search path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("u"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/root/.ansible/plugins/modules'")]),s._v(", u"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/share/ansible/plugins/modules'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  ansible python module location "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/lib/python2.7/site-packages/ansible\n  executable location "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/bin/ansible\n  python version "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.7")]),s._v(".5 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default, Nov "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":23:17"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GCC "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.8")]),s._v(".5 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20150623")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Red Hat "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.8")]),s._v(".5-44"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nUsing /etc/ansible/ansible.cfg as config "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'actionable'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'counter_enabled'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dense'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dense'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'full_skip'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'minimal'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'null'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'oneline'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'selective'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'skippy'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stderr'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'unixy'")]),s._v(", as we already have a stdout callback.\nSkipping callback "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yaml'")]),s._v(", as we already have a stdout callback.\nMETA: ran handlers\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false, \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ping"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pong"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nMETA: ran handlers\nMETA: ran handlers\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h3",{attrs:{id:"使用示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang用户执行ping存活检测")]),s._v("\nansible all -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至root执行ping存活检测，-b默认使用root用户")]),s._v("\nansible all -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k -b\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至mage用户执行ping存活检测")]),s._v("\nansible all -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -u wang -k -b --become-user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mage\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以wang sudo至root用户执行ls,-k 表示wang的password ,-K 表示root的password")]),s._v("\nansible all -m "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -u wang -a "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls /root'")]),s._v(" -b --become-user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -k -K\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible ping模块测试连接")]),s._v("\nansible "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".38.126,192.168.38.127 -m "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" -k \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"ansible-doc-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-doc-命令"}},[s._v("#")]),s._v(" ansible-doc 命令")]),s._v(" "),n("p",[s._v("显示模块帮助")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible-doc "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    -a            显示所有模块的文档 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不常用，显示太多")]),s._v("\n    -l, --list    列出可用模块 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常用")]),s._v("\n    -s, --snippet 显示指定模块的playbook片段"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("简化版,便于查找语法"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"列出所有模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出所有模块"}},[s._v("#")]),s._v(" 列出所有模块")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible-doc -l\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"查看指定模块帮助"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看指定模块帮助"}},[s._v("#")]),s._v(" 查看指定模块帮助")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc ping")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" PING    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/python2.7/site-packages/ansible/modules/system/ping.py"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\t\t A trivial "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" module, this module always returns "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pong'")]),s._v(" on successful contact. It does not "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" sense "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" playbooks, but it is useful from "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/bin/ansible'")]),s._v(" to verify the ability to login and that a usable Python is configured. This is NOT ICMP ping, this is just a trivial "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" module that requires Python on the remote-node. For Windows targets, use the "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("win_ping"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" module instead. For Network targets, use the "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("net_ping"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" module instead.\n\n  * This module is maintained by The Ansible Core Team\nOPTIONS "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" is mandatory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n\n- data\n        Data to "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ping'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" value.\n \t    If this parameter is "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'crash'")]),s._v(", the module will cause an exception.\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Default: pong"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        type: str\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"查看指定模块简化帮助"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看指定模块简化帮助"}},[s._v("#")]),s._v(" 查看指定模块简化帮助")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc -s ping")]),s._v("\n- name: Try to connect to host, verify a usable python and "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pong'")]),s._v(" on success\n  ping:\n      data: "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Data to return for the 'ping' return value. If this parameter is set to 'crash', the module will cause an exception.")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"附-ssh-keygen配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#附-ssh-keygen配置"}},[s._v("#")]),s._v(" 附：ssh-keygen配置")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-keygen")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.10.102")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.10.103")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id 192.168.10.104")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"ansible-galaxy-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-galaxy-命令"}},[s._v("#")]),s._v(" ansible-galaxy 命令")]),s._v(" "),n("blockquote",[n("p",[s._v("通过他人在网上分享的配置，下载使用，访问地址 https://galaxy.ansible.com")])]),s._v(" "),n("h3",{attrs:{id:"安装一个role"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装一个role"}},[s._v("#")]),s._v(" 安装一个role")]),s._v(" "),n("p",[s._v("从访问的网站中，选择一个role进行安装，如geerlingguy.nginx")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible install geerlingguy.nginx")]),s._v("\nusage: ansible "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-h"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-v"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--become-method BECOME_METHOD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--become-user BECOME_USER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-K"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-i INVENTORY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--list-hosts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-l SUBSET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-P POLL_INTERVAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-B "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SECONDS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-o"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-t TREE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-k"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--private-key PRIVATE_KEY_FILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-u REMOTE_USER"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-c CONNECTION"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-T TIMEOUT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--ssh-common-args SSH_COMMON_ARGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--sftp-extra-args SFTP_EXTRA_ARGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--scp-extra-args SCP_EXTRA_ARGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--ssh-extra-args SSH_EXTRA_ARGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-C"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--syntax-check"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-D"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-e EXTRA_VARS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--vault-id VAULT_IDS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--ask-vault-pass "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --vault-password-file VAULT_PASSWORD_FILES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f FORKS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-M MODULE_PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--playbook-dir BASEDIR"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-a MODULE_ARGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-m MODULE_NAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n               pattern\nansible: error: unrecognized arguments: geerlingguy.nginx\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-galaxy install geerlingguy.nginx")]),s._v("\n- downloading role "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx'")]),s._v(", owned by geerlingguy\n- downloading role from https://github.com/geerlingguy/ansible-role-nginx/archive/3.1.1.tar.gz\n- extracting geerlingguy.nginx to /root/.ansible/roles/geerlingguy.nginx\n- geerlingguy.nginx "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v(".1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" was installed successfully\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h3",{attrs:{id:"列出已经安装的配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出已经安装的配置"}},[s._v("#")]),s._v(" 列出已经安装的配置")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-galaxy list")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /root/.ansible/roles")]),s._v("\n- geerlingguy.nginx, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v(".1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/share/ansible/roles")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/ansible/roles")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"删除已安装的配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除已安装的配置"}},[s._v("#")]),s._v(" 删除已安装的配置")]),s._v(" "),n("p",[s._v("可以使用命令删除，也可以直接删除安装后所在的目录/root/.ansible/roles/geerlingguy.nginx达到相同的效果")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v(" ansible-galaxy remove geerlingguy.nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"ansible-pull-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-pull-命令"}},[s._v("#")]),s._v(" ansible-pull 命令")]),s._v(" "),n("p",[s._v("推送命令至远程，效率无限提升，对运维要求较高")]),s._v(" "),n("h2",{attrs:{id:"ansible-playbook-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-playbook-命令"}},[s._v("#")]),s._v(" ansible-playbook 命令")]),s._v(" "),n("blockquote",[n("p",[s._v("帮助文档：ansible-playbook --help\n引用按照标准的yml语言写的脚本，详细使用参考后续的Playbook章节")])]),s._v(" "),n("p",[s._v("示例：执行一个简单的playbook\n创建一个playbook")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" hello.yml\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#hello world yml file")]),s._v("\n- hosts: websrvs\n  remote_user: root\ntasks:\n- name: hello world\n  command: /usr/bin/wall hello world\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("执行")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible-playbook hello.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"ansible-vault-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-vault-命令"}},[s._v("#")]),s._v(" ansible-vault 命令")]),s._v(" "),n("blockquote",[n("p",[s._v("管理加密解密yml文件，主要用于playbook的yml文件的加解密\nansible-vault [create|decrypt|edit|encrypt|rekey|view]")])]),s._v(" "),n("p",[s._v("示例")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("ansible-vault encrypt hello.yml 加密\nansible-vault decrypt hello.yml 解密\nansible-vault view hello.yml    查看\nansible-vault edit hello.yml    编辑加密文件\nansible-vault rekey hello.yml   修改口令\nansible-vault create new.yml    创建新文件\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h2",{attrs:{id:"ansible-console命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ansible-console命令"}},[s._v("#")]),s._v(" ansible-console命令")]),s._v(" "),n("blockquote",[n("p",[s._v("可交互执行命令，支持tab")])]),s._v(" "),n("p",[s._v("示例")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-console")]),s._v("\nWelcome to the ansible console.\nType "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" or ? to list commands.\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置并发数：         forks n   例如： forks 10")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换组：             cd 主机组 例如： cd web")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出当前组主机列表： list")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出所有的内置命令： ?或help")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行用户@当前操作的主机组 (当前组的主机数量)[f:并发数]$")]),s._v("\nroot@all "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ list\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\nroot@all "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" websrvs\nroot@websrvs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ list\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\nroot@websrvs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$  yum "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("httpd "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("present\nroot@websrvs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("f:5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("httpd "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("started\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);