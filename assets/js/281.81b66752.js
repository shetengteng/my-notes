(window.webpackJsonp=window.webpackJsonp||[]).push([[281],{1019:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("模块文档 https://docs.ansible.com/ansible/latest/modules/modules_by_category.html")]),s._v(" "),t("h2",{attrs:{id:"command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[s._v("#")]),s._v(" command")]),s._v(" "),t("blockquote",[t("p",[s._v("在远程主机执行命令，默认模块，可忽略-m选项")])]),s._v(" "),t("h3",{attrs:{id:"查看说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看说明"}},[s._v("#")]),s._v(" 查看说明")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-doc command")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" COMMAND    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/python2.7/site-packages/ansible/modules/commands/command.py"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nOPTIONS "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" is mandatory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n- chdir\n        Change into this directory before running the command.\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Default: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        type: path\n        version_added: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n- creates\n        A filename or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("since "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" glob pattern. If it already exists, this step\n        *won't* be run.\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Default: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        type: path\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n- removes\n        A filename or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("since "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" glob pattern. If it already exists, this step\n        *will* be run.\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Default: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        type: path\n        version_added: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[s._v("**注意：**此命令不支持 "),t("code",[s._v("$VARNAME")]),s._v("  变量名  "),t("code",[s._v("<")]),s._v(" "),t("code",[s._v(">")]),s._v(" 重定向 "),t("code",[s._v("|")]),s._v(" 管道符 "),t("code",[s._v(";")]),s._v(" "),t("code",[s._v("&")]),s._v(" 等操作符，需要用shell模块实现")]),s._v(" "),t("p",[s._v("常用参数说明")]),s._v(" "),t("ul",[t("li",[s._v("chdir:   进入到被管理主机目录")]),s._v(" "),t("li",[s._v("creates: 如果有一个目录是存在，将不会运行命令")]),s._v(" "),t("li",[s._v("removes: 如果有一个目录存在，将会执行命令")]),s._v(" "),t("li",[s._v("默认存不存在目录，都执行")])]),s._v(" "),t("p",[s._v("参数使用")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chdir=/data/ ls'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),t("p",[t("code",[s._v("-a")]),s._v("  表示输入的参数，args的简写")]),s._v(" "),t("p",[s._v("示例1")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible srvs -m "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'service vsftpd start'")]),s._v("\nansible srvs -m "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo adong |passwd --stdin 123456'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("示例2\n创建并列出文件夹，推荐使用file模块创建文件夹")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -a 'mkdir /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Consider using the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" module with "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("directory rather than running "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mkdir'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("  If you need\nto use "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" because "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" is insufficient you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'warn: false'")]),s._v(" to this "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" task or "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'command_warnings=False'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" ansible.cfg to get rid of this message.\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [root@linux101 ~]# ansible all -a 'removes=/opt/my-ansible-test ls -dl /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -a 'removes=/opt/my-ansible-test2 ls -dl /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[s._v("目录存在则执行")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -a 'removes=/opt/my-ansible-test ls -dl /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 /opt/my-ansible-test\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -a 'removes=/opt/my-ansible-test2 ls -dl /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nskipped, since /opt/my-ansible-test2 does not exist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("示例3\n查看分区")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -a 'df -h'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[s._v("#")]),s._v(" shell")]),s._v(" "),t("blockquote",[t("p",[s._v("和command相似，用shell执行命令")])]),s._v(" "),t("p",[s._v("使用shell可以执行command模块中不能使用的特殊符号")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m shell -a 'echo $HOSTNAME'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nlinux103\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nlinux102\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\nlinux104\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("调用bash执行命令 类似 cat /tmp/stanley.md | awk -F'|' '{print $1,$2}' &> /tmp/example.txt  这些复杂命令，即使使用shell也可能会失败，解决办法：写到脚本时，copy到远程执行，再把需要的结果拉回执行命令的机器")]),s._v(" "),t("p",[s._v("可以修改ansible的配置文件，使shell作为默认模块")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ansible/ansible.cfg\nmodule_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" shell\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("示例1")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m shell  -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'getenforce'")]),s._v("  查看SELINUX状态\nansible all -m shell  -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"sed -i 's/SELINUX=.*/SELINUX=disabled' /etc/selinux/config\"")]),s._v("\nansible srv -m shell -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo magedu |passwd –stdin wang'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("示例2")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m shell -a 'ls /opt'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\napache-zookeeper-3.5.9-bin.tar.gz\njdk-8u212-linux-x64.tar.gz\nkafka_2.12-3.0.0.tgz\nmodule\nmy-ansible-test\nrh\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m shell -a 'rm -rf  /opt/my-ansible-test'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Consider using the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" module with "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("absent rather than running "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rm'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("  If you need to use\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" because "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" is insufficient you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'warn: false'")]),s._v(" to this "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" task or "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'command_warnings=False'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" ansible.cfg to get rid of this message.\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"script"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#script"}},[s._v("#")]),s._v(" script")]),s._v(" "),t("blockquote",[t("p",[s._v("在远程主机上运行ansible服务器上的脚本")])]),s._v(" "),t("p",[s._v("使用 ansible-doc script查看使用帮助文档，可参考帮助文档的EXAMPLE")]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--some-arguments")]),s._v(" 给sh脚本传递参数")])]),s._v(" "),t("p",[s._v("示例\n创建执行脚本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim ansible-test.sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod +x ansible-test.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh ansible-test.sh ")]),s._v("\nlinux101\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("使用script执行")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m script -a '/opt/ansible-test.sh'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.103 closed.'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.103 closed."')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux103'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux103"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.102 closed.'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.102 closed."')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux102'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux102"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.104 closed.'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stderr_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Shared connection to 192.168.10.104 closed."')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux104'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdout_lines"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux104"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("h2",{attrs:{id:"copy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[s._v("#")]),s._v(" copy")]),s._v(" "),t("blockquote",[t("p",[s._v("从主控端复制文件到远程主机")])]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("src")]),s._v(" "),t("ul",[t("li",[s._v("源文件")]),s._v(" "),t("li",[s._v("指定拷贝文件的本地路径")]),s._v(" "),t("li",[s._v("如果以 / 结尾，则拷贝整个路径下的所有文件")])])]),s._v(" "),t("li",[t("p",[s._v("dest")]),s._v(" "),t("ul",[t("li",[s._v("指定目标路径")])])]),s._v(" "),t("li",[t("p",[s._v("mode")]),s._v(" "),t("ul",[t("li",[s._v("设置权限")])])]),s._v(" "),t("li",[t("p",[s._v("backup")]),s._v(" "),t("ul",[t("li",[s._v("备份源文件，如果文件已经存在，进行备份操作")])])]),s._v(" "),t("li",[t("p",[s._v("content")]),s._v(" "),t("ul",[t("li",[s._v("代替src")]),s._v(" "),t("li",[s._v("指定本机文件内容,生成目标主机文件")])])])]),s._v(" "),t("p",[s._v("示例：先创建一个txt文件，然后拷贝到其他主机上")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m copy -a 'src=/opt/helloansible.txt dest=/opt/ backup=yes'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"checksum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8689129d4dd7f38370086412eaca315ae9a45611"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dest"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/helloansible.txt"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"md5sum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"486df049b1cbc6eb9724459369698794"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mode"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0644"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"owner"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"secontext"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"system_u:object_r:usr_t:s0"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/root/.ansible/tmp/ansible-tmp-1652579931.17-21255-124200668103281/source"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("示例：如果目标存在，默认覆盖，此处指定先备份，同时可以设置mode和owner")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m copy -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src=/root/test1.sh dest=/tmp/test2.sh owner=wang mode=600 backup=yes"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：指定内容，直接生成目标文件")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m copy -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"content='test content"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("xxx' dest=/tmp/test.txt\"")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"fetch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fetch"}},[s._v("#")]),s._v(" fetch")]),s._v(" "),t("blockquote",[t("p",[s._v("从远程主机提取文件至主控端，copy相反，目前不支持目录,可以先打包,再提取文件\n如抓取日志操作")])]),s._v(" "),t("p",[s._v("查看说明 ansible-doc -s fetch")]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("dest\n"),t("ul",[t("li",[s._v("将抓取的文件放在指定的目录下")]),s._v(" "),t("li",[s._v("如：设置dest为 /backup，远端服务192.168.10.101机器上的/opt/hello.txt文件被抓取，则最终目录是/backup/192.169.10.101/opt/hello.txt")])])]),s._v(" "),t("li",[s._v("src\n"),t("ul",[t("li",[s._v("只能是文件，不能是目录")]),s._v(" "),t("li",[s._v("只能抓取单个文件")])])])]),s._v(" "),t("p",[s._v("示例")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m fetch -a 'src=/opt/helloansible.txt dest=/opt/ansible-fetch'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"checksum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8689129d4dd7f38370086412eaca315ae9a45611"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dest"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/ansible-fetch/192.168.10.104/opt/helloansible.txt"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"md5sum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"486df049b1cbc6eb9724459369698794"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"remote_checksum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8689129d4dd7f38370086412eaca315ae9a45611"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"remote_md5sum"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会生成每个被管理主机不同编号的目录,不会发生文件名冲突")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tree /opt/ansible-fetch/")]),s._v("\n/opt/ansible-fetch/\n├── "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102\n│   └── opt\n│       └── helloansible.txt\n├── "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.103\n│   └── opt\n│       └── helloansible.txt\n└── "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.104\n    └── opt\n        └── helloansible.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("示例：如果远程的文件很多，但是fetch只能抓取一个文件，可以先打包")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m shell -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tar jxvf test.tar.gz /root/test.sh'")]),s._v("\nansible all -m fetch -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=/root/test.tar.gz dest=/data/'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file"}},[s._v("#")]),s._v(" file")]),s._v(" "),t("blockquote",[t("p",[s._v("设置文件属性")])]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("path\n"),t("ul",[t("li",[s._v("要管理的文件路径")]),s._v(" "),t("li",[s._v("是dest 和 name的别名")]),s._v(" "),t("li",[s._v("强制添加")])])]),s._v(" "),t("li",[s._v("recurse\n"),t("ul",[t("li",[s._v("递归")]),s._v(" "),t("li",[s._v("文件夹要用递归")])])]),s._v(" "),t("li",[s._v("src\n"),t("ul",[t("li",[s._v("指定源目标")]),s._v(" "),t("li",[s._v("创建硬链接，软链接，需要配合'state=link' 'state=hard'")])])]),s._v(" "),t("li",[s._v("state\n"),t("ul",[t("li",[s._v("状态")]),s._v(" "),t("li",[s._v("link，hard，touch（创建文件），directory（创建文件夹），absent（删除操作）")])])])]),s._v(" "),t("p",[s._v("示例：创建文件")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible 192.168.10.102 -m file -a 'path=/opt/file3.txt state=touch'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.102 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ansible_facts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovered_interpreter_python"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/python"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changed"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true, \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dest"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/file3.txt"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mode"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0644"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"owner"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"secontext"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unconfined_u:object_r:usr_t:s0"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uid"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("示例：删除文件\n注意：在删除文件夹的时候，如果使用 /xx/* ，那么删除不了xx下的文件夹以及文件，直接使用/xx/即可")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m file -a 'path=/opt/file2.txt state=absent'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：创建文件夹")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@linux101 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible all -m file -a 'path=/opt/file state=directory'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：设置权限")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path=/root/test.sh owner=wang mode=755"')]),s._v("  设置权限755\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：创建软链接")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=/data/testfile dest=/data/testfile-link state=link'")]),s._v(" 创建软链接\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"hostname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hostname"}},[s._v("#")]),s._v(" hostname")]),s._v(" "),t("blockquote",[t("p",[s._v("管理主机名")])]),s._v(" "),t("p",[s._v("示例：更改一个group的主机名")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible appsrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name=app.stt.com"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：更改单个主机名")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".38.103 -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name=app2.stt.com"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"cron"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cron"}},[s._v("#")]),s._v(" cron")]),s._v(" "),t("blockquote",[t("p",[s._v("计划任务\n支持时间：minute,hour,day,month,weekday")])]),s._v(" "),t("p",[s._v("示例：创建任务")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'minute=*/5 job=""/usr/sbin/ntpdate 172.16.0.1 &>/dev/null" name=Synctime\'')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：删除任务")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'state=absent name=Synctime'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：注释任务，不再生效，必须添加name；如果启用则设置disabled=no，或者disabled=false")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'minute=*/10 job=\"/usr/sbin/ntpdate 172.30.0.100\" name=synctime disabled=yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("注意：在命令中的job如果包含多个参数，含有空格，那么job=后面需要用双引号括起来")]),s._v(" "),t("h2",{attrs:{id:"yum"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yum"}},[s._v("#")]),s._v(" yum")]),s._v(" "),t("p",[s._v("安装的前提是其他机器都安装了yum以配置了相同的数据源")]),s._v(" "),t("p",[s._v("示例：查看程序列表")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 依据名称查询")]),s._v("\nansible websrvs -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'list=httpd'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 依据状态查询")]),s._v("\nansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'list=installed'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("示例：安装，state默认present")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=present'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：卸载，可以使用state=absent 或 state=removed")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=absent'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：安装多个包")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=vsftpd,memcached,httpd'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：卸载多个")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=vsftpd,memcached,httpd state=absent'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：安装本地的rpm包")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=/root/vsftpd-3.0.2-22.e17.x86_64.rpm'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁用gpg check")]),s._v("\nansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=/root/vsftpd-3.0.2-22.e17.x86_64.rpm disable_gpg_check=yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("示例：更新某个软件的yum缓存，再安装")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m yum -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=dstat update_cache=yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[s._v("#")]),s._v(" service")]),s._v(" "),t("blockquote",[t("p",[s._v("服务管理")])]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("arguments\n"),t("ul",[t("li",[s._v("可选参数")])])]),s._v(" "),t("li",[s._v("enabled\n"),t("ul",[t("li",[s._v("设置是否开机启动")])])]),s._v(" "),t("li",[s._v("name\n"),t("ul",[t("li",[s._v("服务名称")])])]),s._v(" "),t("li",[s._v("state\n"),t("ul",[t("li",[s._v("stopped，reloaded，restarted，started")])])])]),s._v(" "),t("p",[s._v("示例：停止服务")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=stopped'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：启动服务，并设置为开机启动")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=started enabled=yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：重新加载")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=reloaded'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：重启服务")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=httpd state=restarted'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#user"}},[s._v("#")]),s._v(" user")]),s._v(" "),t("blockquote",[t("p",[s._v("管理用户")])]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("home\n"),t("ul",[t("li",[s._v("指定家目录路径")])])]),s._v(" "),t("li",[s._v("system\n"),t("ul",[t("li",[s._v("指定系统账号")])])]),s._v(" "),t("li",[s._v("group\n"),t("ul",[t("li",[s._v("指定组")])])]),s._v(" "),t("li",[s._v("groups\n"),t("ul",[t("li",[s._v("指定辅助组")])])]),s._v(" "),t("li",[s._v("remove\n"),t("ul",[t("li",[s._v("清除账户，删除夹目录")])])]),s._v(" "),t("li",[s._v("shell\n"),t("ul",[t("li",[s._v("指定shell类型")])])]),s._v(" "),t("li",[s._v("comment\n"),t("ul",[t("li",[s._v("描述")])])]),s._v(" "),t("li",[s._v("state\n"),t("ul",[t("li",[s._v("与上诉其他命令一致")]),s._v(" "),t("li",[s._v("默认present，创建")])])])]),s._v(" "),t("p",[s._v("示例：增加用户user1，主组是root，home目录是/app/user1，指定uid")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m user -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=user1 comment=\"test user\" uid=2048 home=/app/user1 group=root'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：增加系统用户 system=yes")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m user -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=sysuser1 system=yes home=/app/sysuser1'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：清空用户所有数据，包含家目录文件夹数据")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m user -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=user1 state=absent remove=yes'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：创建用户")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m user -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=app uid=88 system=yes home=/app groups=root,bin shell=/sbin/nologin password=\"$1$zfVojmPy$ZILcvxnXljvTI2PhP2Iqv1\"'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：删除账户，但不删除家目录")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m user -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=app state=absent'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"group"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#group"}},[s._v("#")]),s._v(" group")]),s._v(" "),t("blockquote",[t("p",[s._v("用户组管理")])]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("name")]),s._v(" "),t("li",[s._v("state，默认present")]),s._v(" "),t("li",[s._v("system，是否是系统组")]),s._v(" "),t("li",[s._v("gid，组id")])]),s._v(" "),t("p",[s._v("示例：创建组")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m group -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=testgroup system=yes gid=80'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：删除组")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m group -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name=testgroup state=absent'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"unarchive-解包解压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unarchive-解包解压缩"}},[s._v("#")]),s._v(" unarchive 解包解压缩")]),s._v(" "),t("blockquote",[t("p",[s._v("解包解压缩")])]),s._v(" "),t("p",[s._v("使用方法")]),s._v(" "),t("ul",[t("li",[s._v("将ansible主机上的压缩包传到远程主机后解压缩至特定目录，设置copy=yes")]),s._v(" "),t("li",[s._v("将远程主机上的某个压缩包解压缩到指定路径下，设置copy=no")])]),s._v(" "),t("p",[s._v("常见参数")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("copy")]),s._v(" "),t("ul",[t("li",[s._v("默认yes")]),s._v(" "),t("li",[s._v("当copy=yes时，拷贝的文件是从ansible主机复制到远程主机上")]),s._v(" "),t("li",[s._v("当copy=no时，在远程主机上寻找src源文件")])])]),s._v(" "),t("li",[t("p",[s._v("src")]),s._v(" "),t("ul",[t("li",[s._v("源路径")]),s._v(" "),t("li",[s._v("是ansible主机上的路径，或者是远程主机上的路径")]),s._v(" "),t("li",[s._v("如果是远程主机上的路径，则需要设置copy=no")])])]),s._v(" "),t("li",[t("p",[s._v("dest")]),s._v(" "),t("ul",[t("li",[s._v("远程主机上的目标路径")])])]),s._v(" "),t("li",[t("p",[s._v("mode")]),s._v(" "),t("ul",[t("li",[s._v("设置解压缩后的文件权限")])])])]),s._v(" "),t("p",[s._v("示例：默认copy为yes ,将本机目录文件解压到目标主机对应目录下")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m unarchive -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=foo.tgz dest=/var/lib/foo'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：解压被管理主机的foo.zip到data目录下, 并设置权限777")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible websrvs -m unarchive -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=/tmp/foo.zip dest=/data copy=no mode=0777'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("示例：从网络上下载并解压，注意copy=no")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v(" ansible websrvs -m unarchive -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=https://example.com/example.zip dest=/data copy=no'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"archive-打包压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#archive-打包压缩"}},[s._v("#")]),s._v(" archive 打包压缩")]),s._v(" "),t("p",[s._v("常用参数")]),s._v(" "),t("ul",[t("li",[s._v("path，指定路径")]),s._v(" "),t("li",[s._v("dest，指定目标文件")]),s._v(" "),t("li",[s._v("format，指定打包格式")]),s._v(" "),t("li",[s._v("owner，指定所属者")]),s._v(" "),t("li",[s._v("mode，设置权限")])]),s._v(" "),t("p",[s._v("示例")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("ansible all -m archive -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/etc/sysconfig dest=/data/sysconfig.tar.bz2 format=bz2 owner=wang mode=0777'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);