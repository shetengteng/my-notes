(window.webpackJsonp=window.webpackJsonp||[]).push([[193],{1307:function(_,v,e){"use strict";e.r(v);var l=e(15),i=Object(l.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h2",{attrs:{id:"在部署es时-linux-的设置有哪些优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在部署es时-linux-的设置有哪些优化"}},[_._v("#")]),_._v(" 在部署ES时 Linux 的设置有哪些优化")]),_._v(" "),e("ul",[e("li",[_._v("64 GB 内存的机器是非常理想的， 但是 32 GB 和 16 GB 机器也是很常见的。少于 8 GB 会适得其反")]),_._v(" "),e("li",[_._v("如果要在更快的 CPUs 和更多的核心之间选择，"),e("strong",[_._v("选择更多的核心")]),_._v("更好。多个内核提供的额外并发远胜过稍微快一点点的时钟频率")]),_._v(" "),e("li",[_._v("如果负担得起 SSD，它将远远超出任何旋转介质。 基于 SSD 的节点，查询和索引性能都有提升")]),_._v(" "),e("li",[_._v("即使数据中心们近在咫尺，也要"),e("strong",[_._v("避免集群跨越多个数据中心")]),_._v(" "),e("ul",[e("li",[_._v("绝对要避免集群跨越大的地理距离")])])]),_._v(" "),e("li",[_._v("请确保运行应用程序的 JVM 和服务器的 JVM 是完全一样的\n"),e("ul",[e("li",[_._v("在 Elasticsearch 的几个地方，使用 Java 的本地序列化")])])]),_._v(" "),e("li",[_._v("通过设置 gateway.recover_after_nodes、 gateway.expected_nodes、 gateway.recover_after_time 可以在集群重启的时候避免过多的分片交换，这可能会让数据恢复从数个小时缩短为几秒钟")]),_._v(" "),e("li",[_._v("Elasticsearch 默认被配置为使用单播发现，以防止节点无意中加入集群\n"),e("ul",[e("li",[_._v("只有在同一台机器上运行的节点才会自动组成集群")]),_._v(" "),e("li",[_._v("最好使用单播代替组播")])])]),_._v(" "),e("li",[_._v("不要随意修改垃圾回收器（CMS）和各个线程池的大小")]),_._v(" "),e("li",[_._v("把少于内存的一半给 Lucene（但不要超过 32 GB），通过 ES_HEAP_SIZE 环境变量设置")]),_._v(" "),e("li",[_._v("内存交换到磁盘对服务器性能来说是致命的\n"),e("ul",[e("li",[_._v("如果内存交换到磁盘上，一个 100 微秒的操作可能变成 10 毫秒。 那么多 10 微秒的操作时延累加起来。 不难看出 swapping 对于性能是多么可怕")])])]),_._v(" "),e("li",[_._v("Lucene 使用了大量的文件。同时， Elasticsearch 在节点和 HTTP 客户端之间进行通信也使用了大量的套接字。 所有这一切都需要足够的文件描述符。应该增加文件描述符，设置一个很大的值，如 64,000")])]),_._v(" "),e("h2",{attrs:{id:"索引阶段性能提升方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#索引阶段性能提升方法"}},[_._v("#")]),_._v(" 索引阶段性能提升方法")]),_._v(" "),e("ul",[e("li",[_._v("使用批量请求并调整其大小：每次批量数据 5–15 MB 大是个不错的起始点")]),_._v(" "),e("li",[_._v("存储：使用 SSD")]),_._v(" "),e("li",[_._v("段和合并：Elasticsearch 默认值是 20 MB/s，对机械磁盘应该是个不错的设置\n"),e("ul",[e("li",[_._v("如果用的是 SSD，可考虑提高到 100–200 MB/s")]),_._v(" "),e("li",[_._v("如果在做批量导入，完全不在意搜索，可以彻底关掉合并限流")]),_._v(" "),e("li",[_._v("可以增加 index.translog.flush_threshold_size 设置，从默认的 512 MB 到更大一些的值，比如 1\nGB，可以在一次清空触发的时候在事务日志里积累出更大的段")])])]),_._v(" "),e("li",[_._v("如果搜索结果不需要近实时的准确度，考虑把每个索引的 index.refresh_interval 改到 30s")]),_._v(" "),e("li",[_._v("如果在做大批量导入，考虑通过设置 index.number_of_replicas: 0 关闭副本")])])])}),[],!1,null,null,null);v.default=i.exports}}]);