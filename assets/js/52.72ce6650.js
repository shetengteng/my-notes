(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1215:function(t,a,s){"use strict";s.r(a);var n=s(15),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"微信扫码支付"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#微信扫码支付"}},[t._v("#")]),t._v(" 微信扫码支付")]),t._v(" "),n("p",[t._v("微信扫码支付是商户系统按微信支付协议生成支付二维码，用户再用微信“扫一扫”完成支付的模式。该模式适用于PC网站支付、实体店单品或订单支付、媒体广告支付等场景")]),t._v(" "),n("h2",{attrs:{id:"使用场景-案例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-案例"}},[t._v("#")]),t._v(" 使用场景&案例")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("场景")]),t._v(" "),n("ul",[n("li",[t._v("用户扫描商户展示在各种场景的二维码进行支付")])])]),t._v(" "),n("li",[n("p",[t._v("使用案例")]),t._v(" "),n("ul",[n("li",[t._v("线下：家乐福超市、7-11便利店、上品折扣线下店等")]),t._v(" "),n("li",[t._v("线上：大众点评网站、携程网站、唯品会、美丽说网站等")])])])]),t._v(" "),n("h2",{attrs:{id:"开发模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发模式"}},[t._v("#")]),t._v(" 开发模式")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("模式一")]),t._v(" "),n("ul",[n("li",[t._v("商户在后台给生成二维码，用户打开扫一扫")])])]),t._v(" "),n("li",[n("p",[t._v("模式二")]),t._v(" "),n("ul",[n("li",[t._v("商户后台系统调用微信支付【"),n("a",{attrs:{href:"https://pay.weixin.qq.com/wiki/doc/api/native.php?chapter=9_1",target:"_blank",rel:"noopener noreferrer"}},[t._v("统一下单API"),n("OutboundLink")],1),t._v("】生成预付交易，将接口返回的链接生成二维码，用户扫码后输入密码完成支付交易")]),t._v(" "),n("li",[t._v("注意：该模式的预付单有效期为2小时，过期后无法支付")])])])]),t._v(" "),n("h2",{attrs:{id:"申请步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#申请步骤"}},[t._v("#")]),t._v(" 申请步骤")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("注册公众号")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("类型须为服务号")])]),t._v(" "),n("li",[n("p",[t._v("请根据营业执照类型选择以下主体注册："),n("a",{attrs:{href:"http://kf.qq.com/faq/120911VrYVrA151009JB3i2Q.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("个体工商户"),n("OutboundLink")],1),t._v("| "),n("a",{attrs:{href:"http://kf.qq.com/faq/120911VrYVrA151013MfYvYV.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("企业/公司"),n("OutboundLink")],1),t._v("| "),n("a",{attrs:{href:"http://kf.qq.com/faq/161220eaAJjE161220IJn6zU.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("政府"),n("OutboundLink")],1),t._v("| "),n("a",{attrs:{href:"http://kf.qq.com/faq/161220IFBJFv161220YnqAbQ.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("媒体"),n("OutboundLink")],1),t._v("| "),n("a",{attrs:{href:"http://kf.qq.com/faq/120911VrYVrA151013nYFZ7Z.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("其他类型"),n("OutboundLink")],1)])])])]),t._v(" "),n("li",[n("p",[t._v("认证公众号")]),t._v(" "),n("ul",[n("li",[t._v("公众号认证后才可申请微信支付，认证费：300元/年")])])]),t._v(" "),n("li",[n("p",[t._v("提交资料申请微信支付")]),t._v(" "),n("ul",[n("li",[t._v("登录公众平台，点击左侧菜单【微信支付】，开始填写资料等待审核，审核时间为1-5个工作日内")])])]),t._v(" "),n("li",[n("p",[t._v("开户成功，登录商户平台进行验证")]),t._v(" "),n("ul",[n("li",[t._v("资料审核通过后，请登录联系人邮箱查收商户号和密码，并登录商户平台填写财付通备付金打的小额资金数额，完成账户验证")])])]),t._v(" "),n("li",[n("p",[t._v("在线签署协议")]),t._v(" "),n("ul",[n("li",[t._v("本协议为线上电子协议，签署后方可进行交易及资金结算，签署完立即生效")])])])]),t._v(" "),n("h2",{attrs:{id:"开发文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发文档"}},[t._v("#")]),t._v(" 开发文档")]),t._v(" "),n("p",[t._v("微信支付接口调用的整体思路")]),t._v(" "),n("ul",[n("li",[t._v("按API要求组装参数，以"),n("strong",[t._v("XML")]),t._v("方式发送 POST 给微信支付接口URL")]),t._v(" "),n("li",[t._v("微信支付接口以"),n("strong",[t._v("XML")]),t._v("方式给予响应")]),t._v(" "),n("li",[t._v("程序根据返回的结果（其中包括支付URL）生成二维码或判断订单状态")])]),t._v(" "),n("p",[t._v("在线微信支付开发文档")]),t._v(" "),n("p",[t._v("https://pay.weixin.qq.com/wiki/doc/api/index.html")]),t._v(" "),n("p",[t._v("配置")]),t._v(" "),n("ul",[n("li",[t._v("appid\n"),n("ul",[n("li",[t._v("微信公众账号或开放平台APP的唯一标识")])])]),t._v(" "),n("li",[t._v("mch_id\n"),n("ul",[n("li",[t._v("商户号 (配置文件中的partner)")])])]),t._v(" "),n("li",[t._v("partnerkey\n"),n("ul",[n("li",[t._v("商户密钥")])])]),t._v(" "),n("li",[t._v("sign\n"),n("ul",[n("li",[t._v("数字签名,")]),t._v(" "),n("li",[t._v("根据微信官方提供的密钥和一套算法生成的一个加密信息, 就是为了保证交易的安全性")])])])]),t._v(" "),n("h2",{attrs:{id:"支付流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#支付流程"}},[t._v("#")]),t._v(" 支付流程")]),t._v(" "),n("p",[t._v("https://pay.weixin.qq.com/wiki/doc/api/native.php?chapter=6_5&index=3")]),t._v(" "),n("p",[n("img",{attrs:{src:s(753),alt:"原生支付模式二时序图"}})]),t._v(" "),n("h2",{attrs:{id:"微信支付sdk"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#微信支付sdk"}},[t._v("#")]),t._v(" 微信支付SDK")]),t._v(" "),n("p",[t._v("示例下载")]),t._v(" "),n("p",[t._v("https://pay.weixin.qq.com/wiki/doc/api/native.php?chapter=11_1")]),t._v(" "),n("p",[n("img",{attrs:{src:s(754),alt:""}})]),t._v(" "),n("p",[t._v("添加依赖")]),t._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.github.wxpay"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("wxpay-sdk"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("0.0.3"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("p",[t._v("主要会用到微信支付SDK的以下功能")]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取随机字符串")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WXPayUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateNonceStr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// MAP转换为XML字符串（自动添加签名）")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WXPayUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateSignedXml")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("param"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" partnerkey"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// XML字符串转换为MAP")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WXPayUtil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("xmlToMap")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports},753:function(t,a,s){t.exports=s.p+"assets/img/1.83e312a2.png"},754:function(t,a,s){t.exports=s.p+"assets/img/3.889f458a.png"}}]);